import{bG as c,bN as g,bO as p,ba as y}from"./index-Bk13oInq.js";import{a as m}from"./WebMap-B1OSGX1Q.js";import"./ColorBackground-eCqVLvQh.js";import"./Cyclical-DJv7mGBZ.js";import"./Basemap-DRYqJJ3x.js";import"./writeUtils-CuGAkQa7.js";import"./catalogUtils-8MGqu6UW.js";import"./basemapUtils-CYwIlTGS.js";import"./TablesMixin-C8r3nFk7.js";import"./jsonContext-DtZJBWTs.js";import"./project-C0HSHKI9.js";async function R(a,e,o){const t=c(a),r=e.toJSON();r.traceLocations=JSON.stringify(e.traceLocations),e.resultTypes&&(r.resultTypes=JSON.stringify(e.resultTypes));const n=g(t.query,{query:p({...r,f:"json"}),...o}),i=`${t.path}/trace`;return y(i,n).then(s=>u(s,e.outSpatialReference))}async function q(a,e,o){const t=c(a),r=e.toJSON();r.traceLocations=JSON.stringify(e.traceLocations),e.resultTypes&&(r.resultTypes=JSON.stringify(e.resultTypes));const n=g(t.query,{query:p({...r,async:!0,f:"json"}),...o}),i=`${t.path}/trace`,{data:s}=await y(i,n);return s.statusUrl}function u(a,e){const{data:o}=a,t=m.fromJSON(o.traceResults);return t.aggregatedGeometry&&e&&(t.aggregatedGeometry.line&&(t.aggregatedGeometry.line.spatialReference=e.clone()),t.aggregatedGeometry.multipoint&&(t.aggregatedGeometry.multipoint.spatialReference=e.clone()),t.aggregatedGeometry.polygon&&(t.aggregatedGeometry.polygon.spatialReference=e.clone())),t}export{q as submitTraceJob,R as trace};
