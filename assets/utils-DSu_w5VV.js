const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/symbolLayerUtils-BeiwkeA9.js","assets/index-BmjI5m14.js","assets/index-CXj0dB5Q.css"])))=>i.map(i=>d[i]);
import{cB as c,hJ as $,hK as M,hL as C,hM as S,hN as E,eC as _,c5 as f,gq as O,U as R,fS as m,hO as p,hP as F,hQ as A,m as N,hR as T,gO as U,hS as D}from"./index-BmjI5m14.js";function I(t){const o=[];return d($(t),o),o.length?new c(E(o[0])):null}function d(t,o){var l;if(!t)return;let e;e=t.type==="CIMTextSymbol"?t.symbol:t;const n=t.type==="CIMPolygonSymbol";if(e!=null&&e.symbolLayers){for(const r of e.symbolLayers)if(!(r.colorLocked||n&&(M(r)||C(r)&&r.markerPlacement&&S(r.markerPlacement))))switch(r.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":r.tintColor&&k(o,r.tintColor);break;case"CIMVectorMarker":(l=r.markerGraphics)==null||l.forEach(s=>{d(s.symbol,o)});break;case"CIMSolidStroke":case"CIMSolidFill":k(o,r.color);break;case"CIMHatchFill":d(r.lineSymbol,o)}}}function k(t,o){for(const e of t)if(e.join(".")===o.join("."))return;t.push(o)}function at(t,o,e){o instanceof c||(o=new c(o));const n=$(t);n&&w(n,o)}function w(t,o,e){var r;if(!t)return;let n;n=t.type==="CIMTextSymbol"?t.symbol:t;const l=(n==null?void 0:n.type)==="CIMPolygonSymbol";if(n!=null&&n.symbolLayers)for(const s of n.symbolLayers){if(s.colorLocked||l&&(M(s)||C(s)&&s.markerPlacement&&S(s.markerPlacement)))continue;const i=o.toArray();switch(s.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":s.tintColor=i;break;case"CIMVectorMarker":(r=s.markerGraphics)==null||r.forEach(a=>{w(a.symbol,o)});break;case"CIMSolidStroke":case"CIMSolidFill":s.color=i;break;case"CIMHatchFill":w(s.lineSymbol,o)}}}const L="picture-fill",x="simple-fill",H="simple-line",P="simple-marker",V="text",G="cim",g=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),b=new _(1e3);function it(t){const o=t.style;let e=null;if(t)switch(t.type){case P:o!=="cross"&&o!=="x"&&(e=t.color);break;case x:o&&o!=="solid"?o!=="none"&&(e={type:"pattern",x:0,y:0,src:O(`esri/symbols/patterns/${o}.png`),width:5,height:5}):e=t.color;break;case L:e={type:"pattern",src:t.url,width:f(t.width)*t.xscale,height:f(t.height)*t.yscale,x:f(t.xoffset),y:f(t.yoffset)};break;case V:e=t.color;break;case G:e=I(t)}return e}function ct(t,o){const e=t+"-"+o;return b.get(e)!==void 0?Promise.resolve(b.get(e)):R(t,{responseType:"image"}).then(n=>{const l=n.data,r=l.naturalWidth,s=l.naturalHeight,i=document.createElement("canvas");i.width=r,i.height=s;const a=i.getContext("2d");a.fillStyle=o,a.fillRect(0,0,r,s),a.globalCompositeOperation="destination-in",a.drawImage(l,0,0);const u=i.toDataURL();return b.put(e,u),u})}function j(t){if(!t)return null;let o=null;switch(t.type){case x:case L:case P:o=j(t.outline);break;case H:{const e=f(t.width);t.style!=null&&t.style!=="none"&&e!==0&&(o={color:t.color,style:q(t.style),width:e,cap:t.cap,join:t.join==="miter"?f(t.miterLimit):t.join},o.dashArray=J(o).join(",")||"none");break}default:o=null}return o}function J(t){if(!(t!=null&&t.style))return[];const{dashArray:o,style:e,width:n}=t;if(typeof o=="string"&&o!=="none")return o.split(",").map(s=>Number(s));const l=n??0,r=g.has(e)?g.get(e).map(s=>s*l):[];if(t.cap!=="butt")for(const[s,i]of r.entries())r[s]=s%2==1?i+l:Math.max(i-l,1);return r}const q=(()=>{const t={};return o=>{if(t[o])return t[o];const e=o.replaceAll("-","");return t[o]=e,e}})(),ut=new c([128,128,128]),B=new c("white");function K(t){var e,n;const o=(e=t.symbolLayers)==null?void 0:e.at(-1);if(o&&"outline"in o)return(n=o==null?void 0:o.outline)==null?void 0:n.size}function ft(t){var o;if(!t)return 0;if(m(t)){const e=K(t);return e??0}return U((o=j(t))==null?void 0:o.width)}function yt(t){if(t==null||!("symbolLayers"in t)||t.symbolLayers==null)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some(o=>o.type==="object");case"line-3d":return t.symbolLayers.some(o=>o.type==="path");case"polygon-3d":return t.symbolLayers.some(o=>o.type==="object"||o.type==="extrude");default:return!1}}function ht(t){var o;return((o=t.resource)==null?void 0:o.href)??""}function mt(t,o){if(!t)return null;let e=null;return m(t)?e=Q(t):p(t)&&(e=t.type==="cim"?I(t):t.color?new c(t.color):null),e?h(e,o):null}function Q(t){const o=t.symbolLayers;if(!o)return null;let e=null;return o.forEach(n=>{var l;n.type==="object"&&((l=n.resource)!=null&&l.href)||(e=n.type==="water"?n.color:n.material?n.material.color:null)}),e?new c(e):null}function h(t,o){if(o==null||t==null)return t;const e=t.toRgba();return e[3]=e[3]*o,new c(e)}function W(t,o,e){const n=t.symbolLayers;if(!n)return;const l=r=>h(o=o??r??(e!=null?B:null),e);n.forEach(r=>{var s,i;if(r.type!=="object"||!((s=r.resource)!=null&&s.href)||o)if(r.type==="water")r.color=l(r.color);else{const a=r.material!=null?r.material.color:null,u=l(a);r.material==null?r.material=new D({color:u}):r.material.color=u,e!=null&&"outline"in r&&((i=r.outline)==null?void 0:i.color)!=null&&(r.outline.color=h(r.outline.color,e))}})}function X(t,o,e){var n;(o=o??t.color)&&(t.color=h(o,e)),e!=null&&"outline"in t&&((n=t.outline)!=null&&n.color)&&(t.outline.color=h(t.outline.color,e))}function pt(t,o,e){t&&(o||e!=null)&&(o&&(o=new c(o)),m(t)?W(t,o,e):p(t)&&X(t,o,e))}async function Y(t,o){const e=t.symbolLayers;e&&await F(e,async n=>Z(n,o))}async function Z(t,o){switch(t.type){case"extrude":ot(t,o);break;case"icon":case"line":case"text":tt(t,o);break;case"path":nt(t,o);break;case"object":await et(t,o)}}function tt(t,o){const e=z(o);e!=null&&(t.size=e)}function z(t){for(const o of t)if(typeof o=="number")return o;return null}function ot(t,o){t.size=typeof o[2]=="number"?o[2]:0}async function et(t,o){const{resourceSize:e,symbolSize:n}=await rt(t),l=v(o,e,n);t.width=y(o[0],n[0],e[0],l),t.depth=y(o[1],n[1],e[1],l),t.height=y(o[2],n[2],e[2],l)}function nt(t,o){const e=v(o,A,[t.width,void 0,t.height]);t.width=y(o[0],t.width,1,e),t.height=y(o[2],t.height,1,e)}function v(t,o,e){for(let n=0;n<3;n++){const l=t[n];switch(l){case"symbol-value":{const r=e[n];return r!=null?r/o[n]:1}case"proportional":break;default:if(l&&o[n])return l/o[n]}}return 1}async function rt(t){const{computeObjectLayerResourceSize:o}=await N(()=>import("./symbolLayerUtils-BeiwkeA9.js"),__vite__mapDeps([0,1,2])),e=await o(t,10),{width:n,height:l,depth:r}=t,s=[n,r,l];let i=1;for(let a=0;a<3;a++){const u=s[a];if(u!=null){i=u/e[a];break}}for(let a=0;a<3;a++)s[a]==null&&(s[a]=e[a]*i);return{resourceSize:e,symbolSize:s}}function y(t,o,e,n){switch(t){case"proportional":return e*n;case"symbol-value":return o??e;default:return t}}function lt(t,o){const e=z(o);if(e!=null)switch(t.type){case"simple-marker":t.size=e;break;case"picture-marker":{const n=t.width/t.height;n>1?(t.width=e,t.height=e*n):(t.width=e*n,t.height=e);break}case"simple-line":t.width=e;break;case"text":t.font.size=e}}async function bt(t,o){if(t&&o)return m(t)?Y(t,o):void(p(t)&&lt(t,o))}function dt(t,o,e){if(t&&o!=null)if(m(t)){const n=t.symbolLayers;n&&n.forEach(l=>{if(l&&l.type==="object")switch(e){case"tilt":l.tilt=(l.tilt??0)+o;break;case"roll":l.roll=(l.roll??0)+o;break;default:l.heading=(l.heading??0)+o}})}else p(t)&&(t.type!=="simple-marker"&&t.type!=="picture-marker"&&t.type!=="text"||(t.angle+=o))}function wt(t){if(!t)return null;const o=t.effects.filter(e=>e.type!=="bloom").map(e=>e.toJSON());return T(o)}async function kt(t,o){return await t.fetchSymbol(o)||t.fetchCIMSymbol(o)}export{dt as D,wt as I,kt as N,bt as R,yt as a,ut as b,pt as c,at as d,ct as f,J as g,mt as h,ft as m,ht as p,it as u,q as w,j as y};
