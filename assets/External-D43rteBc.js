import{cN as z,gq as C,i6 as D,i7 as E,i8 as G,i9 as W,eY as H,e as a,y as u,bg as Y,b7 as J,ia as K,b8 as L,cM as h,ib as Q,br as R,gf as V,a as X,l as Z,cS as I,ba as _,ic as tt,aN as rt,aO as st}from"./index-3fJYBySH.js";import{e as N}from"./mat4f64-CSKppSlJ.js";import{v as O,I as y,x as et}from"./quat-C7XYwAOd.js";import{e as b}from"./quatf64-Bdb9ZJJK.js";function o(t=k){return[t[0],t[1],t[2],t[3]]}function f(t,r,s=o()){return z(s,t),s[3]=r,s}function ht(t,r=o()){const s=W(l,t);return S(r,H(O(r,s))),r}function v(t,r,s=o()){return y(l,t,m(t)),y(x,r,m(r)),et(l,x,l),S(s,H(O(s,l)))}function pt(t,r,s,e=o()){return f(D,t,p),f(E,r,M),f(G,s,d),v(p,M,p),v(p,d,e),e}function ft(t){return t}function nt(t){return t[3]}function m(t){return C(t[3])}function S(t,r){return t[3]=r,t}const k=[0,0,1,0],l=b(),x=b();o();const p=o(),M=o(),d=o();var $;let n=$=class extends Y{constructor(t){super(t),this.translation=J(),this.rotationAxis=K(k),this.rotationAngle=0,this.scale=L(1,1,1)}get rotation(){return f(this.rotationAxis,this.rotationAngle)}set rotation(t){this.rotationAxis=h(t),this.rotationAngle=nt(t)}get localMatrix(){const t=N();return y(w,this.rotation,m(this.rotation)),Q(t,w,this.translation,this.scale),t}get localMatrixInverse(){return R(N(),this.localMatrix)}equals(t){return this===t||t!=null&&V(this.localMatrix,t.localMatrix)}clone(){const t={translation:h(this.translation),rotationAxis:h(this.rotationAxis),rotationAngle:this.rotationAngle,scale:h(this.scale)};return new $(t)}};a([u({type:[Number],nonNullable:!0,json:{write:!0}})],n.prototype,"translation",void 0),a([u({type:[Number],nonNullable:!0,json:{write:!0}})],n.prototype,"rotationAxis",void 0),a([u({type:Number,nonNullable:!0,json:{write:!0}})],n.prototype,"rotationAngle",void 0),a([u({type:[Number],nonNullable:!0,json:{write:!0}})],n.prototype,"scale",void 0),a([u()],n.prototype,"rotation",null),a([u()],n.prototype,"localMatrix",null),a([u()],n.prototype,"localMatrixInverse",null),n=$=a([X("esri.geometry.support.MeshTransform")],n);const w=b(),yt=n;class F{constructor(r,s,e){this.assetName=r,this.assetMimeType=s,this.parts=e}equals(r){return this===r||this.assetName===r.assetName&&this.assetMimeType===r.assetMimeType&&Z(this.parts,r.parts,(s,e)=>s.equals(e))}isOnService(r){return this.parts.every(s=>s.isOnService(r))}makeHash(){let r="";for(const s of this.parts)r+=s.partHash;return r}async toBlob(r){const{parts:s}=this;if(s.length===1)return s[0].toBlob(r);const e=await Promise.all(s.map(c=>c.toBlob(r)));return I(r),new Blob(e)}}class mt{constructor(r,s){this.partUrl=r,this.partHash=s}equals(r){return this===r||this.partUrl===r.partUrl&&this.partHash===r.partHash}isOnService(r){return this.partUrl.startsWith(`${r.path}/assets/`)}async toBlob(r){const{data:s}=await _(this.partUrl,{responseType:"blob"});return I(r),s}}function $t(t){return at(t==null?void 0:t.source)}function q(t){return Array.isArray(t)?t.every(r=>r instanceof F):!1}const B=/^(model\/gltf\+json)|(model\/gltf-binary)$/,T=/\.(gltf|glb)/i;function at(t){return t?Array.isArray(t)?t.some(U):U(t):!1}function U(t){if(t instanceof File){const{type:r,name:s}=t;return B.test(r)||T.test(s)}return B.test(t.assetMimeType)||T.test(t.assetName)}function bt(t,r){if(!t)return!1;const{source:s}=t;return ot(s,r)}function gt(t,r){if(t===r)return!0;const{source:s}=t,{source:e}=r;if(s===e)return!0;if(q(s)&&q(e)){if(s.length!==e.length)return!1;const c=(i,A)=>i.assetName<A.assetName?-1:i.assetName>A.assetName?1:0,g=[...s].sort(c),P=[...e].sort(c);for(let i=0;i<g.length;++i)if(!g[i].equals(P[i]))return!1;return!0}return!1}function ot(t,r){if(Array.isArray(t)){const s=t;return s.length>0&&s.every(e=>j(e,r))}return j(t,r)}function j(t,r){return t instanceof F&&t.isOnService(r)}function At(t,r){return t instanceof File?tt(t,r):rt(t.assetMimeType,r)??st(t.assetName,r)}function Nt(t){return Array.isArray(t)?t:[t]}function vt(t){return!!t.original}export{Nt as A,yt as N,At as a,o as b,m as c,ft as d,bt as h,F as i,ht as k,mt as o,$t as u,vt as v,pt as w,gt as y};
